{% extends 'base.html' %}

{% block body %}
<section>
    <h1>Task Details</h1>
    <p><strong>Task:</strong> {{ task.content }}</p>
    <p><strong>Created:</strong> {{ task.created_at.strftime("%Y-%m-%d") }}</p>

    <h2>Comments</h2>
    {% for comment in comments %}
        <div>
            <p><strong>{{ comment.user.username }}</strong>: {{ comment.content }}</p>
            <p>Posted on {{ comment.created_at.strftime("%Y-%m-%d") }}</p>
            <div class="dropdown">
                <button class="dropbtn">Options</button>
                <div class="dropdown-content">
                    <form action="{{ url_for('add_comment', task_id=task.id) }}" method="POST">
                        <textarea name="comment" placeholder="Add a comment" required></textarea>
                        <button type="submit">Add Comment</button>
                    </form>
                    <form action="{{ url_for('edit_todo', id=task.id) }}" method="GET">
                        <button type="submit">Edit</button>
                    </form>
                    <form action="{{ url_for('delete_todo', id=task.id) }}" method="POST">
                        <button type="submit">Delete</button>
                    </form>
                </div>
            </div>
        </div>
    {% endfor %}

    <!-- Add Comment Form -->
    <form action="{{ url_for('add_comment', task_id=task.id) }}" method="POST">
        <textarea name="comment" placeholder="Add a comment" required></textarea>
        <input type="submit" value="Submit Comment">
    </form>
</section>
{% endblock %}